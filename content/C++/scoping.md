---
title: 4. C++ - –û–±–ª–∞—Å—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç–∏
tags:
  - cxx
---
### –ü—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –∏–º–µ–Ω
–ó–∞ *—Ä–µ–¥–∫–∏–º–∏* –∏—Å–∫–ª—é—á–µ–Ω–∏—è–º–∏, –≤–∞—à –∫–æ–¥ –¥–æ–ª–∂–µ–Ω –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –∏–º–µ–Ω.

–•–æ—Ä–æ—à–µ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –∏–º–µ–Ω —Å–æ–¥–µ—Ä–∂–∏—Ç:
- –ò–º—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∏/–ø—Ä–æ–µ–∫—Ç–∞
- –ü—É—Ç—å –∫ –∑–∞–≥–æ–ª–æ–≤–æ—á–Ω–æ–º—É —Ñ–∞–π–ª—É

> [!example] –ü—Ä–∏–º–µ—Ä
> –ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –∑–∞–≥–æ–ª–æ–≤–æ—á–Ω—ã–π —Ñ–∞–π–ª, –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—â–∏–π –∫ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ `animals` –∏ –ª–µ–∂–∞—â–∏–π –≤ –ø–∞–ø–∫–µ `include/animals/mammals/cute/cat.h`, —Ç–æ –∏–¥–µ–∞–ª—å–Ω—ã–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ–º –∏–º–µ–Ω –±—É–¥–µ—Ç: `animals::mammals::cute`.
#### –î–∏—Ä–µ–∫—Ç–∏–≤–∞ `using`
–ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–∏—Ä–µ–∫—Ç–∏–≤—É `using` –≤ –≥–ª–æ–±–∞–ª—å–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –∏–º–µ–Ω –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∞—Ö. –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –µ–µ –≤–Ω—É—Ç—Ä–∏ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –∏–º–µ–Ω, –æ–±—ä—è–≤–ª–µ–Ω–Ω–æ–≥–æ –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ (–∞ –µ—â–µ –ª—É—á—à–µ, –≤–Ω—É—Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–π, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞ )

–î–ª—è —ç—Ç–æ–≥–æ –ø—Ä–∞–≤–∏–ª–∞ –µ—Å—Ç—å –∏—Å–∫–ª—é—á–µ–Ω–∏—è, –Ω–æ –≤ –æ–±—â–µ–º —Å–ª—É—á–∞–µ –æ–Ω–æ –¥–æ–ª–∂–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è.

#### –ë–µ–∑—ã–º—è–Ω–Ω—ã–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –∏–º–µ–Ω
–ï—Å–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è –∏–ª–∏ –∫–ª–∞—Å—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ —Ñ–∞–π–ª–∞, –≤ –∫–æ—Ç–æ—Ä–æ–º –æ–Ω–∞ –æ–±—ä—è–≤–ª–µ–Ω–∞, —Ç–æ —Ö–æ—Ä–æ—à–∏–º —Ç–æ–Ω–æ–º –±—É–¥–µ—Ç –ø–æ–º–µ—Å—Ç–∏—Ç—å –µ–µ –≤ –±–µ–∑—ã–º—è–Ω–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –∏–º–µ–Ω, –Ω–∞–ø—Ä–∏–º–µ—Ä:
```cpp
namespace {
	auto add(int x, int y) -> int { return x + y; }
}

auto main() {
	return ::add(0, 0);
}
```
–í—ã–∑–æ–≤ —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –¥–∞–ª—å–Ω–µ–π—à–µ–º –±—É–¥–µ—Ç –æ—Å—É—â–µ—Å—Ç–≤–ª—è—Ç—å—Å—è —Å –ø–æ–º–æ—â—å—é –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ `::`.
–ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ–± —ç—Ç–æ–º: [Stackoverflow](https://stackoverflow.com/questions/1358400/what-is-external-linkage-and-internal-linkage)

> [!caution] –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
> –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç—É –ø—Ä–∞–∫—Ç–∏–∫—É –≤ –∑–∞–≥–æ–ª–æ–≤–æ—á–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö.

#### –ü—Ä–æ—á–∏–µ –∑–∞–º–µ—á–∞–Ω–∏—è
- –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `inline namespace`.
- –ù–µ –æ–±—ä—è–≤–ª—è–π—Ç–µ –Ω–∏—á–µ–≥–æ –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –∏–º–µ–Ω `std::`.

### –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
–ù–µ –Ω—É–∂–Ω–æ –ø–æ–º–µ—â–∞—Ç—å —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –∫–ª–∞—Å—Å, –µ—Å–ª–∏ –æ–Ω–∏ –Ω–µ –ø—Ä–∏–≤—è–∑–∞–Ω—ã –ª–æ–≥–∏—á–µ—Å–∫–∏ –∏ —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏ –∫ —ç—Ç–æ–º—É –∫–ª–∞—Å—Å—É; –Ω–µ –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –∫–ª–∞—Å—Å —Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏. –ü—Ä–∞–≤–∏–ª—å–Ω–æ–π –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–æ–π —ç—Ç–æ–º—É –±—É–¥–µ—Ç –ø–æ–º–µ—â–∞—Ç—å *—Å–≤–æ–±–æ–¥–Ω—ã–µ* —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –∏–º–µ–Ω.

–ü—Ä–∏–º–µ—Ä:
```cpp
/* üò° –ø–ª–æ—Ö–æ */
class Math {
	static auto add(int x, int y) -> int;
	static auto subtract(int x, int y) -> int;
};

/* üòä —Ö–æ—Ä–æ—à–æ */
namespace math {
	[[nodiscard]] auto add(int x, int y) -> int;
	[[nodiscard]] auto subtract(int x, int y) -> int;
}
```

> [!help] –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ
> –ò—Å–∫–ª—é—á–µ–Ω–∏–µ–º –º–æ–∂–µ—Ç —è–≤–ª—è—Ç—å—Å—è —ç–∫—Å–ø–æ—Ä—Ç –≥—Ä—É–ø–ø—ã —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è **QML**, –æ–¥–Ω–∞–∫–æ –≤ —Ç–∞–∫–æ–º —Å–ª—É—á–∞–µ –ª—É—á—à–∏–º —Ä–µ—à–µ–Ω–∏–µ–º –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ *–∫–ª–∞—Å—Å–∞-–æ–±–µ—Ä—Ç–∫–∏* –¥–ª—è —Å–≤–æ–±–æ–¥–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π.

### –õ–æ–∫–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
–ü–æ–º–µ—â–∞–π—Ç–µ –ª–æ–∫–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–∞—Å—Ç–æ–ª—å–∫–æ –≤ –æ–±–æ—Å–æ–±–ª–µ–Ω–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏ –≤–∏–¥–∏–º–æ—Å—Ç–∏, –Ω–∞—Å–∫–æ–ª—å–∫–æ —ç—Ç–æ –≤–æ–∑–º–æ–∂–Ω–æ. –°–æ–±–ª—é–¥–∞–π—Ç–µ –ø—Ä–∏–Ω—Ü–∏–ø **RAII** ([Wikipedia](https://ru.wikipedia.org/wiki/%D0%9F%D0%BE%D0%BB%D1%83%D1%87%D0%B5%D0%BD%D0%B8%D0%B5_%D1%80%D0%B5%D1%81%D1%83%D1%80%D1%81%D0%B0_%D0%B5%D1%81%D1%82%D1%8C_%D0%B8%D0%BD%D0%B8%D1%86%D0%B8%D0%B0%D0%BB%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F)). –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –æ–±—ä—è–≤–ª—è–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –±–µ–∑ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏.

**–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ `auto` –∏ `auto const`**.  –û–Ω–∏ –∑–∞–ø—Ä–µ—â–∞—é—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –Ω–µ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö.
###### –ü—Ä–∏–º–µ—Ä 1
```cpp
/* üò° –ø–ª–æ—Ö–æ */
int i;
i = 1;

/* üòä —Ö–æ—Ä–æ—à–æ */
auto const i = 1; 
```

###### –ü—Ä–∏–º–µ—Ä 2
```cpp
/* üò° –ø–ª–æ—Ö–æ */
std::vector<int> a;
a.push_back(1);
a.push_back(2);

/* üòä —Ö–æ—Ä–æ—à–æ */
auto const a = std::vector<int>{1, 2};
```

###### –ü—Ä–∏–º–µ—Ä 3
```cpp
/* üò° –ø–ª–æ—Ö–æ */
int* a = static_cast<int*>(malloc(1024));
if(a != nullptr)
	return a;
return make_unexpected("error allocating 1024 bytes");

/* üòä —Ö–æ—Ä–æ—à–æ */
// –æ–±–ª–∞—Å—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç–∏ `a` - —É—Å–ª–æ–≤–∏–µ if –∏ –µ–≥–æ –≤–µ—Ç–≤–∏.
if(auto a = static_cast<int*>(malloc(1024)); a != nullptr) 
	return a;
return make_unexpected("error allocating 1024 bytes");
```

### –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –∏ –ª–æ–∫–∞–ª—å–Ω—ã–µ –¥–ª—è –ø–æ—Ç–æ–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
–°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–æ–ª–∂–Ω—ã **–≤—Å–µ–≥–¥–∞** –∏–º–µ—Ç—å —Ç—Ä–∏–≤–∏–∞–ª—å–Ω—ã–π –¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä. –ü–æ—á—Ç–∏ –≤—Å–µ–≥–¥–∞ –∏–∑ —ç—Ç–æ–≥–æ –ø—Ä–∞–≤–∏–ª–∞ —Å–ª–µ–¥—É–µ—Ç —Ç–æ, —á—Ç–æ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å `constexpr`.

##### –û–±—â–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
###### –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Å—Ç—Ä–æ–∫–∏
```cpp
using namespace std::string_view_literals;

constexpr auto PROJECT_NAME = "meow"sv;
```

###### –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã (`std::map`, `std::set`, etc.)
–ó–∞–ø—Ä–µ—â–∞–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –≤ —Å–æ—á–µ—Ç–∞–Ω–∏–∏ —Å –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–æ `static`, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ –∏–º–µ—é—Ç –Ω–µ—Ç—Ä–∏–≤–∏–∞–ª—å–Ω—ã–π –¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä.

–í –∫–∞—á–µ—Å—Ç–≤–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `std::array` —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞, –ª–∏–±–æ –ø–µ—Ä–µ—Å–º–æ—Ç—Ä –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã —Å–≤–æ–µ–≥–æ –∫–æ–¥–∞.

–ü–æ —Ç–æ–π –∂–µ –ø—Ä–∏—á–∏–Ω–µ **—É–º–Ω—ã–µ —É–∫–∞–∑–∞—Ç–µ–ª–∏** –Ω–µ –¥–æ–ª–∂–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤ —Å–æ—á–µ—Ç–∞–Ω–∏–∏ —Å –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–æ–º `static`.

###### –°–≤–æ–∏ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö
–î–ª—è –ø—Ä–æ—á–∏—Ö —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö –≤ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–π –ø–∞–º—è—Ç–∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è  2 –ø—Ä–∞–≤–∏–ª–∞:
- –ù–∞–ª–∏—á–∏–µ `constexpr`-–∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞
- –ù–∞–ª–∏—á–∏–µ —Ç—Ä–∏–≤–∏–∞–ª—å–Ω–æ–≥–æ –¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞

##### –õ–æ–∫–∞–ª—å–Ω—ã–µ –¥–ª—è –ø–æ—Ç–æ–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
–ö–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ `thread_local` –¥–æ–ª–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –≤ —Å–æ—á–µ—Ç–∞–Ω–∏–∏ —Å –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–æ–º `constinit`.
```cpp
constinit thread_local auto cat = /* ... */;
```

#### –î–∞–ª–µ–µ: [[functions|–§—É–Ω–∫—Ü–∏–∏]]